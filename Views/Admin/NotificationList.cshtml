@model IEnumerable<ProjectTest1.ViewModels.OrderNotificationViewModel>
@using ProjectTest1.Enums

@foreach (var n in Model)
{
    <li id="notif-item-@n.Id" class="list-group-item p-0">
        @{
            string onclickAction = n.Type switch
            {
                NotificationType.Comment => $"window.location.href='{n.Url}'",
                NotificationType.Order => $"admin.detail({n.OrderId ?? 0}, {n.Id})",
                _ => ""
            };
        }

        <button class="notif-btn d-flex align-items-start w-100 text-start" onclick="@onclickAction">
            <div class="notif-info flex-grow-1 d-flex">
                <img src="@n.Image" alt="Notif Image" class="notif-img" />
                <div class="notif-text">
                    <strong class="notif-title">@n.Title</strong>
                    <div class="notif-message">@n.Message</div>
                    <div class="notif-time">
                        <i class="bi bi-clock me-1 text-muted"></i>
                        @n.CreatedAt.ToString("HH:mm dd/MM/yyyy")
                    </div>
                </div>
            </div>
            @if (!n.IsRead)
            {
                <span id="notif-dot-@n.Id" class="notif-dot"></span>
            }
        </button>
    </li>
}
<style>
     /* Toàn bộ nút thông báo */
     .notif-btn {
         border: none;
         background: none;
         padding: 14px 12px;
         transition: background-color 0.2s ease;
     }

         .notif-btn:hover {
             background-color: #f8f9fa;
         }

     /* Ảnh và phần chữ */
     .notif-info {
         display: flex;
         align-items: flex-start;
         gap: 12px;
     }

     /* Ảnh avatar */
     .notif-img {
         width: 46px;
         height: 46px;
         border-radius: 50%;
         object-fit: cover;
         border: 1px solid #dee2e6;
     }

     /* Nội dung text */
     .notif-text {
         display: flex;
         flex-direction: column;
         gap: 2px;
     }

     .notif-title {
         font-size: 15.5px;
         font-weight: 600;
         color: #212529;
     }

     .notif-message {
         font-size: 14px;
         color: #555;
         line-height: 1.4;
         margin-top: 2px;
         display: -webkit-box; /* bật chế độ multi-line clamp */
         -webkit-box-orient: vertical;
         -webkit-line-clamp: 3; /* hiển thị tối đa 3 dòng */
         overflow: hidden; /* ẩn phần dư */
         text-overflow: ellipsis; /* thêm dấu ... */
         word-break: break-word; /* ngắt từ nếu quá dài */
     }


     .notif-time {
         font-size: 13px;
         color: #6c757d;
         margin-top: 4px;
     }

     /* Dấu chấm xanh unread */
     .notif-dot {
         width: 10px;
         height: 10px;
         background-color: #0d6efd;
         border-radius: 50%;
         margin-left: 10px;
         margin-top: 6px;
         flex-shrink: 0;
     }

</style>